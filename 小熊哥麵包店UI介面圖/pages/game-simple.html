<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç†Šå“¥éºµåŒ…åº— - åƒç´ é¢¨è¡ŒéŠ·æ•™è‚²éŠæˆ²</title>
    <link rel="stylesheet" href="../styles/styles.css">
</head>
<body>
    <!-- é ‚éƒ¨å°èˆªæ¬„ -->
    <nav id="navbar">
        <div class="nav-container">
            <div class="logo">ğŸ å°ç†Šå“¥éºµåŒ…åº—</div>
            <div class="nav-menu" id="nav-menu">
                <button class="nav-btn active" data-section="profile">ç©å®¶è³‡æ–™</button>
                <button class="nav-btn" data-section="inventory">é€²è²¨ç³»çµ±</button>
                <button class="nav-btn" data-section="game">éŠæˆ²æ¨¡å¼</button>
                <button class="nav-btn" data-section="reports">éŠ·å”®å ±è¡¨</button>
                <button class="nav-btn" data-section="settings">è¨­å®š</button>
                <button class="nav-btn logout-btn" id="logout-btn">ğŸ  è¿”å›é¦–é </button>
            </div>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å…§å®¹å€åŸŸ -->
    <main id="main-content">
        <!-- 1. ç©å®¶è³‡æ–™ -->
        <section id="profile" class="section active">
            <div class="container">
                <div class="profile-box">
                    <h2>ç©å®¶è³‡æ–™</h2>
                    <div class="profile-content">
                        <div class="avatar-section">
                            <div class="avatar" id="playerAvatar">ğŸ§‘â€ğŸ³</div>
                            <button class="pixel-btn small" onclick="changeAvatar()">æ›´æ›é ­åƒ</button>
                        </div>
                        <div class="player-info">
                            <div class="info-item">
                                <label>ç©å®¶åç¨±ï¼š</label>
                                <span id="playerName">å°ç†Šå“¥</span>
                                <button class="pixel-btn small" onclick="changeName()">è®Šæ›´åç¨±</button>
                            </div>
                            <div class="info-item">
                                <label>ç­‰ç´šï¼š</label>
                                <span id="playerLevel">1</span>
                            </div>
                            <div class="info-item">
                                <label>éŠæˆ²å¹£ï¼š</label>
                                <span id="playerCoins">1000</span> ğŸ’°
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 2. é€²è²¨/åº«å­˜ç³»çµ± -->
        <section id="inventory" class="section">
            <div class="container">
                <h2>é€²è²¨ï¼åº«å­˜ç³»çµ±</h2>
                <div class="inventory-grid">
                    <div class="bread-item">
                        <div class="bread-icon">ğŸ</div>
                        <h3>ç™½åå¸</h3>
                        <p>åº«å­˜ï¼š<span id="bread1-stock">10</span></p>
                        <div class="purchase-controls">
                            <input type="number" id="bread1-qty" value="1" min="1">
                            <button class="pixel-btn small" onclick="purchaseBread('bread1', 50)">é€²è²¨ ($50)</button>
                        </div>
                    </div>
                    <div class="bread-item">
                        <div class="bread-icon">ğŸ¥–</div>
                        <h3>æ³•å¼éºµåŒ…</h3>
                        <p>åº«å­˜ï¼š<span id="bread2-stock">5</span></p>
                        <div class="purchase-controls">
                            <input type="number" id="bread2-qty" value="1" min="1">
                            <button class="pixel-btn small" onclick="purchaseBread('bread2', 80)">é€²è²¨ ($80)</button>
                        </div>
                    </div>
                    <div class="bread-item">
                        <div class="bread-icon">ğŸ¥</div>
                        <h3>å¯é Œ</h3>
                        <p>åº«å­˜ï¼š<span id="bread3-stock">8</span></p>
                        <div class="purchase-controls">
                            <input type="number" id="bread3-qty" value="1" min="1">
                            <button class="pixel-btn small" onclick="purchaseBread('bread3', 120)">é€²è²¨ ($120)</button>
                        </div>
                    </div>
                    <div class="bread-item">
                        <div class="bread-icon">ğŸ§</div>
                        <h3>æ¯å­è›‹ç³•</h3>
                        <p>åº«å­˜ï¼š<span id="bread4-stock">15</span></p>
                        <div class="purchase-controls">
                            <input type="number" id="bread4-qty" value="1" min="1">
                            <button class="pixel-btn small" onclick="purchaseBread('bread4', 30)">é€²è²¨ ($30)</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. ä¸»è¦éŠæˆ²ä»‹é¢ -->
        <section id="game" class="section">
            <div class="container">
                <div class="game-box">
                    <div id="story-section" class="game-content active">
                        <h2>è¡ŒéŠ·æ•™è‚²åŠ‡æƒ…</h2>
                        <div class="story-content">
                            <div class="story-page active" id="story-1">
                                <h3>ç¬¬ä¸€ç« ï¼šé–‹åº—æº–å‚™</h3>
                                <p>å°ç†Šå“¥æ±ºå®šé–‹ä¸€å®¶éºµåŒ…åº—ï¼Œä½†ä»–ç™¼ç¾å…‰æœƒåšéºµåŒ…é‚„ä¸å¤ ï¼Œé‚„éœ€è¦å­¸æœƒå¦‚ä½•è¡ŒéŠ·...</p>
                            </div>
                            <div class="story-page" id="story-2" style="display: none;">
                                <h3>ç¬¬äºŒç« ï¼šèªè­˜å®¢ç¾¤</h3>
                                <p>ä¸åŒçš„å®¢äººæœ‰ä¸åŒçš„éœ€æ±‚ï¼Œäº†è§£ç›®æ¨™å®¢ç¾¤æ˜¯æˆåŠŸè¡ŒéŠ·çš„ç¬¬ä¸€æ­¥...</p>
                            </div>
                            <div class="story-page" id="story-3" style="display: none;">
                                <h3>ç¬¬ä¸‰ç« ï¼šå®šåƒ¹ç­–ç•¥</h3>
                                <p>å¦‚ä½•ç‚ºéºµåŒ…å®šåƒ¹ï¼Ÿå¤ªé«˜æœƒæ²’äººè²·ï¼Œå¤ªä½åˆè³ºä¸åˆ°éŒ¢...</p>
                            </div>
                            <div class="story-page" id="story-4" style="display: none;">
                                <h3>ç¬¬å››ç« ï¼šå®£å‚³æ¨å»£</h3>
                                <p>å¥½çš„ç”¢å“ä¹Ÿéœ€è¦å¥½çš„å®£å‚³ï¼Œè®“æ›´å¤šäººçŸ¥é“å°ç†Šå“¥çš„éºµåŒ…åº—...</p>
                            </div>
                        </div>
                        <div class="story-controls">
                            <button class="pixel-btn" onclick="previousStory()" id="prev-story">ä¸Šä¸€é </button>
                            <span id="story-progress">1 / 4</span>
                            <button class="pixel-btn" onclick="nextStory()" id="next-story">ä¸‹ä¸€é </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. éŠ·å”®å ±è¡¨ -->
        <section id="reports" class="section">
            <div class="container">
                <h2>éŠ·å”®å ±è¡¨</h2>
                <div class="report-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>ç¸½æ”¶å…¥</h3>
                            <div class="stat-value" id="total-income">$2,500</div>
                        </div>
                        <div class="stat-card">
                            <h3>ç¸½æ”¯å‡º</h3>
                            <div class="stat-value" id="total-expense">$1,200</div>
                        </div>
                        <div class="stat-card">
                            <h3>æ·¨åˆ©æ½¤</h3>
                            <div class="stat-value profit" id="net-profit">$1,300</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 5. è¨­å®šé é¢ -->
        <section id="settings" class="section">
            <div class="container">
                <h2>éŠæˆ²è¨­å®š</h2>
                <div class="settings-content">
                    <div class="setting-group">
                        <h3>éŸ³è¨Šè¨­å®š</h3>
                        <div class="setting-item">
                            <label for="music-volume">éŸ³æ¨‚éŸ³é‡</label>
                            <input type="range" id="music-volume" min="0" max="100" value="50">
                            <span id="music-value">50%</span>
                        </div>
                        <div class="setting-item">
                            <label for="sound-effects">é»æ“ŠéŸ³æ•ˆ</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="sound-effects" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="setting-group">
                        <h3>é¡¯ç¤ºè¨­å®š</h3>
                        <div class="setting-item">
                            <label for="brightness">ç•«é¢æ˜äº®åº¦</label>
                            <input type="range" id="brightness" min="30" max="150" value="100">
                            <span id="brightness-value">100%</span>
                        </div>
                    </div>
                    <div class="setting-group">
                        <h3>éŠæˆ²è¨­å®š</h3>
                        <button class="pixel-btn secondary" onclick="resetProgress()">é‡ç½®éŠæˆ²é€²åº¦</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // ç°¡åŒ–çš„éŠæˆ²ç‹€æ…‹ç®¡ç†
        let gameState = {
            currentSection: 'profile',
            isLoggedIn: false,
            isGuestMode: false,
            playerData: {
                name: 'å°ç†Šå“¥',
                avatar: 'ğŸ§‘â€ğŸ³',
                level: 1,
                coins: 1000
            },
            inventory: {
                bread1: 10,
                bread2: 5,
                bread3: 8,
                bread4: 15
            },
            currentStory: 1
        };

        // è¼‰å…¥éŠæˆ²ç‹€æ…‹
        function loadGameState() {
            try {
                const savedData = localStorage.getItem('bearBakeryGameState');
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    gameState = { ...gameState, ...parsedData };
                }
            } catch (error) {
                console.error('è¼‰å…¥éŠæˆ²ç‹€æ…‹å¤±æ•—:', error);
            }
        }

        // ä¿å­˜éŠæˆ²ç‹€æ…‹
        function saveGameState() {
            try {
                localStorage.setItem('bearBakeryGameState', JSON.stringify(gameState));
            } catch (error) {
                console.error('ä¿å­˜éŠæˆ²ç‹€æ…‹å¤±æ•—:', error);
            }
        }

        // é¡¯ç¤ºæŒ‡å®šå€æ®µ
        function showSection(sectionId) {
            // éš±è—æ‰€æœ‰å€æ®µ
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // é¡¯ç¤ºç›®æ¨™å€æ®µ
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                gameState.currentSection = sectionId;
                saveGameState();
            }

            // æ›´æ–°å°èˆªæŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.section === sectionId) {
                    btn.classList.add('active');
                }
            });
        }

        // æ›´æ–°ç©å®¶è³‡è¨Šé¡¯ç¤º
        function updatePlayerInfo() {
            document.getElementById('playerName').textContent = gameState.playerData.name || 'å°ç†Šå“¥';
            document.getElementById('playerAvatar').textContent = gameState.playerData.avatar || 'ğŸ§‘â€ğŸ³';
            document.getElementById('playerLevel').textContent = gameState.playerData.level || 1;
            document.getElementById('playerCoins').textContent = gameState.playerData.coins || 1000;
        }

        // æ›´æ–°åº«å­˜é¡¯ç¤º
        function updateInventoryDisplay() {
            Object.keys(gameState.inventory).forEach(breadType => {
                const stockElement = document.getElementById(`${breadType}-stock`);
                if (stockElement) {
                    stockElement.textContent = gameState.inventory[breadType];
                }
            });
        }

        // ç©å®¶åŠŸèƒ½
        function changeName() {
            const newName = prompt('è«‹è¼¸å…¥æ–°çš„ç©å®¶åç¨±ï¼š', gameState.playerData.name);
            if (newName && newName.trim()) {
                gameState.playerData.name = newName.trim();
                updatePlayerInfo();
                saveGameState();
                alert('åç¨±å·²æ›´æ–°ï¼');
            }
        }

        function changeAvatar() {
            const avatars = ['ğŸ§‘â€ğŸ³', 'ğŸ‘¨â€ğŸ³', 'ğŸ‘©â€ğŸ³', 'ğŸ§‘â€ğŸ’¼', 'ğŸ‘¨â€ğŸ’¼', 'ğŸ‘©â€ğŸ’¼', 'ğŸ§‘', 'ğŸ‘¨', 'ğŸ‘©', 'ğŸ‘¤'];
            const currentIndex = avatars.indexOf(gameState.playerData.avatar);
            const nextIndex = (currentIndex + 1) % avatars.length;
            
            gameState.playerData.avatar = avatars[nextIndex];
            updatePlayerInfo();
            saveGameState();
        }

        // é€²è²¨åŠŸèƒ½
        function purchaseBread(breadType, cost) {
            const qtyInput = document.getElementById(`${breadType}-qty`);
            const quantity = parseInt(qtyInput.value) || 1;
            const totalCost = cost * quantity;

            if (gameState.playerData.coins >= totalCost) {
                gameState.playerData.coins -= totalCost;
                gameState.inventory[breadType] += quantity;
                
                updatePlayerInfo();
                updateInventoryDisplay();
                saveGameState();
                
                alert(`æˆåŠŸé€²è²¨ ${quantity} å€‹ï¼èŠ±è²» $${totalCost}`);
            } else {
                alert('éŠæˆ²å¹£ä¸è¶³ï¼');
            }
        }

        // åŠ‡æƒ…åŠŸèƒ½
        function previousStory() {
            if (gameState.currentStory > 1) {
                gameState.currentStory--;
                updateStoryDisplay();
                saveGameState();
            }
        }

        function nextStory() {
            if (gameState.currentStory < 4) {
                gameState.currentStory++;
                updateStoryDisplay();
                saveGameState();
            }
        }

        function updateStoryDisplay() {
            // éš±è—æ‰€æœ‰æ•…äº‹é é¢
            document.querySelectorAll('.story-page').forEach(page => {
                page.style.display = 'none';
                page.classList.remove('active');
            });

            // é¡¯ç¤ºç•¶å‰æ•…äº‹
            const currentPage = document.getElementById(`story-${gameState.currentStory}`);
            if (currentPage) {
                currentPage.style.display = 'block';
                currentPage.classList.add('active');
            }

            // æ›´æ–°é€²åº¦é¡¯ç¤º
            document.getElementById('story-progress').textContent = `${gameState.currentStory} / 4`;
        }

        // è¨­å®šåŠŸèƒ½
        function resetProgress() {
            if (confirm('ç¢ºå®šè¦é‡ç½®æ‰€æœ‰éŠæˆ²é€²åº¦å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸï¼')) {
                localStorage.removeItem('bearBakeryGameState');
                location.reload();
            }
        }

        // è¿”å›é¦–é 
        function goHome() {
            if (gameState.isGuestMode) {
                window.location.href = './index.html';
            } else {
                if (confirm('ç¢ºå®šè¦è¿”å›é¦–é å—ï¼Ÿ')) {
                    window.location.href = './index.html';
                }
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ ç²¾ç°¡ç‰ˆéŠæˆ²è¼‰å…¥ä¸­...');
            
            // è¼‰å…¥éŠæˆ²ç‹€æ…‹
            loadGameState();
            
            // æª¢æŸ¥ç™»å…¥ç‹€æ…‹
            if (!gameState.isLoggedIn) {
                gameState.isGuestMode = true;
                gameState.playerData.name = 'è¨ªå®¢ç©å®¶';
                gameState.playerData.avatar = 'ğŸ‘¤';
            }

            // æ›´æ–°UI
            updatePlayerInfo();
            updateInventoryDisplay();
            updateStoryDisplay();

            // è¨­å®šäº‹ä»¶ç›£è½å™¨
            document.querySelectorAll('.nav-btn:not(.logout-btn)').forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.dataset.section;
                    if (section) {
                        showSection(section);
                    }
                });
            });

            // è¿”å›æŒ‰éˆ•
            document.getElementById('logout-btn').addEventListener('click', goHome);

            // æ¼¢å ¡é¸å–®
            document.getElementById('hamburger').addEventListener('click', function() {
                document.getElementById('nav-menu').classList.toggle('active');
                this.classList.toggle('active');
            });

            // è¨­å®šæ»‘æ¡¿äº‹ä»¶
            const brightnessSlider = document.getElementById('brightness');
            const brightnessValue = document.getElementById('brightness-value');
            brightnessSlider.addEventListener('input', function() {
                const value = this.value;
                brightnessValue.textContent = value + '%';
                document.body.style.filter = `brightness(${value/100})`;
            });

            const musicSlider = document.getElementById('music-volume');
            const musicValue = document.getElementById('music-value');
            musicSlider.addEventListener('input', function() {
                musicValue.textContent = this.value + '%';
            });

            console.log('âœ… ç²¾ç°¡ç‰ˆéŠæˆ²è¼‰å…¥å®Œæˆï¼');
            console.log('ç™»å…¥ç‹€æ…‹:', gameState.isLoggedIn);
            console.log('è¨ªå®¢æ¨¡å¼:', gameState.isGuestMode);
            console.log('ç©å®¶åç¨±:', gameState.playerData.name);
        });
    </script>
</body>
</html> 